<!doctype html><html xmlns=http://www.w3.org/1999/xhtml xml:lang=en-us lang=en-us><head><script defer language=javascript type=text/javascript src=/js/bundle.min.11d62625e7495f8147fccf5d08f37bded574a50c4508c235cc666848567d99ab.js></script><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link rel=icon href=https://mwtaylor.github.io/ElephantLogos/elephant_itr100.png><title itemprop=name>Elephant in the Room - Federating Your New Server</title><meta property="og:title" content="Elephant in the Room - Federating Your New Server"><meta name=twitter:title content="Elephant in the Room - Federating Your New Server"><meta itemprop=name content="Elephant in the Room - Federating Your New Server"><meta name=application-name content="Elephant in the Room - Federating Your New Server"><meta property="og:site_name" content="Elephant In The Room"><meta name=description content><meta itemprop=description content><meta property="og:description" content><meta name=twitter:description content><base href=https://elephantintheroom.dev/posts/mastodon-federation/><link rel=canonical href=https://elephantintheroom.dev/posts/mastodon-federation/ itemprop=url><meta name=url content="https://elephantintheroom.dev/posts/mastodon-federation/"><meta name=twitter:url content="https://elephantintheroom.dev/posts/mastodon-federation/"><meta property="og:url" content="https://elephantintheroom.dev/posts/mastodon-federation/"><meta property="og:updated_time" content="12009-12-09T957:21:23-0700"><link rel=sitemap type=application/xml title=Sitemap href=https://elephantintheroom.dev/sitemap.xml><meta name=robots content="index,follow"><meta name=googlebot content="index,follow"><meta name=twitter:site content><meta name=twitter:creator content><meta property="fb:admins" content><meta name=apple-mobile-web-app-title content="Elephant In The Room"><meta name=apple-mobile-web-app-capable content="yes"><meta name=apple-mobile-web-app-status-bar-style content="black"><meta property="og:type" content="article"><meta property="article:publisher" content><meta property="og:article:published_time" content="12009-12-09T957:21:23-0700"><meta property="article:published_time" content="12009-12-09T957:21:23-0700"><script defer type=application/ld+json>{"@context":"http://schema.org","@type":"Article","headline":"Federating Your New Server","author":{"@type":"Person","name":"https:\/\/github.com\/mwtaylor\/DevelopmentBlog"},"datePublished":"2023-09-12","description":"","wordCount":"1495","mainEntityOfPage":"True","dateModified":"2023-09-12","image":{"@type":"imageObject","url":""},"publisher":{"@type":"Organization","name":"Elephant In The Room","logo":{"@type":"imageObject","url":"https:\/\/mwtaylor.github.io\/ElephantLogos\/elephant_itr100.png"}}}</script><meta name=generator content="Hugo 0.119.0"><link type=text/css rel=stylesheet href=/css/bundle.min.e4d2e07519de0d647d95780d40511e30cbf08ee614a8f73dd5db19838f26a412.css><style>body{--sidebar-bg-color:#202020;--sidebar-img-border-color:#515151;--sidebar-p-color:#909090;--sidebar-h1-color:#FFF;--sidebar-a-color:#FFF;--sidebar-socials-color:#FFF;--text-color:#222;--bkg-color:#FAF9F6;--post-title-color:#303030;--list-color:#5a5a5a;--link-color:#268bd2;--date-color:#515151;--table-border-color:#E5E5E5;--table-stripe-color:#F9F9F9;--code-color:#bf616a;--code-background-color:#E5E5E5;--moon-sun-color:#FFF;--moon-sun-background-color:#515151}body.dark-theme{--text-color:#eee;--bkg-color:#121212;--post-title-color:#DBE2E9;--list-color:#9d9d9d;--link-color:#268bd2;--date-color:#9a9a9a;--table-border-color:#515151;--table-stripe-color:#202020;--code-color:#ff7f7f;--code-background-color:#393D47}body{background-color:var(--bkg-color)}</style></head><body><div class=wrapper><aside class=sidebar><div class="container sidebar-sticky"><div class=light-dark align=right><button class=btn-light-dark title="Toggle light/dark mode"><svg class="moon" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16"><path fill="currentcolor" d="M6 .278a.768.768.0 01.08.858 7.208 7.208.0 00-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527.0 1.04-.055 1.533-.16a.787.787.0 01.81.316.733.733.0 01-.031.893A8.349 8.349.0 018.344 16C3.734 16 0 12.286.0 7.71.0 4.266 2.114 1.312 5.124.06A.752.752.0 016 .278z"/></svg><svg class="sun" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16"><path fill="currentcolor" d="M8 12a4 4 0 100-8 4 4 0 000 8zM8 0a.5.5.0 01.5.5v2a.5.5.0 01-1 0v-2A.5.5.0 018 0zm0 13a.5.5.0 01.5.5v2a.5.5.0 01-1 0v-2A.5.5.0 018 13zm8-5a.5.5.0 01-.5.5h-2a.5.5.0 010-1h2a.5.5.0 01.5.5zM3 8a.5.5.0 01-.5.5h-2a.5.5.0 010-1h2A.5.5.0 013 8zm10.657-5.657a.5.5.0 010 .707l-1.414 1.415a.5.5.0 11-.707-.708l1.414-1.414a.5.5.0 01.707.0zm-9.193 9.193a.5.5.0 010 .707L3.05 13.657a.5.5.0 01-.707-.707l1.414-1.414a.5.5.0 01.707.0zm9.193 2.121a.5.5.0 01-.707.0l-1.414-1.414a.5.5.0 01.707-.707l1.414 1.414a.5.5.0 010 .707zM4.464 4.465a.5.5.0 01-.707.0L2.343 3.05a.5.5.0 11.707-.707l1.414 1.414a.5.5.0 010 .708z"/></svg></button></div><div class=sidebar-about><h1 class=brand><a href=https://elephantintheroom.dev/><img src=https://mwtaylor.github.io/ElephantLogos/elephant_itr400.png alt="brand image"></a>
<a href=https://elephantintheroom.dev/><h1>Elephant In The Room</h1></a></h1><p class=lead></p></div><nav><ul class=sidebar-nav><li class=heading><a href=/about/>About</a></li><li class=heading><a href=/posts/>Posts</a></li><li class=sub-heading>Recent</li><li class=bullet><a href=https://elephantintheroom.dev/posts/mastodon-storage-management/>Mastodon Storage Management</a></li><li class=bullet><a href=https://elephantintheroom.dev/posts/mastodon-basic-monitoring/>Mastodon Basic Monitoring</a></li><li class=bullet><a href=https://elephantintheroom.dev/posts/mastodon-federation/>Federating Your New Server</a></li><li class=bullet><a href=https://elephantintheroom.dev/posts/mastodon-setup/>Starting a Personal Mastodon Server</a></li></ul></nav><a target=_blank class=social title=GitHub href=https://github.com/mwtaylor/DevelopmentBlog><svg xmlns="http://www.w3.org/2000/svg" width="1.2em" height="1.2em" viewBox="-2 -2 24 24"><path fill="currentcolor" d="M18.88 1.099C18.147.366 17.265.0 16.233.0H3.746C2.714.0 1.832.366 1.099 1.099.366 1.832.0 2.714.0 3.746v12.487c0 1.032.366 1.914 1.099 2.647.733.733 1.615 1.099 2.647 1.099H6.66c.19.0.333-.007.429-.02a.504.504.0 00.286-.169c.095-.1.143-.245.143-.435l-.007-.885c-.004-.564-.006-1.01-.006-1.34l-.3.052c-.19.035-.43.05-.721.046a5.555 5.555.0 01-.904-.091 2.026 2.026.0 01-.872-.39 1.651 1.651.0 01-.572-.8l-.13-.3a3.25 3.25.0 00-.41-.663c-.186-.243-.375-.407-.566-.494l-.09-.065a.956.956.0 01-.17-.156.723.723.0 01-.117-.182c-.026-.061-.004-.111.065-.15.07-.04.195-.059.378-.059l.26.04c.173.034.388.138.643.311a2.1 2.1.0 01.631.677c.2.355.44.626.722.813.282.186.566.28.852.28.286.0.533-.022.742-.065a2.59 2.59.0 00.585-.196c.078-.58.29-1.028.637-1.34a8.907 8.907.0 01-1.333-.234 5.314 5.314.0 01-1.223-.507 3.5 3.5.0 01-1.047-.872c-.277-.347-.505-.802-.683-1.365-.177-.564-.266-1.215-.266-1.952.0-1.049.342-1.942 1.027-2.68-.32-.788-.29-1.673.091-2.652.252-.079.625-.02 1.119.175.494.195.856.362 1.086.5.23.14.414.257.553.352a9.233 9.233.0 012.497-.338c.859.0 1.691.113 2.498.338l.494-.312a6.997 6.997.0 011.197-.572c.46-.174.81-.221 1.054-.143.39.98.424 1.864.103 2.653.685.737 1.028 1.63 1.028 2.68.0.737-.089 1.39-.267 1.957-.177.568-.407 1.023-.689 1.366a3.65 3.65.0 01-1.053.865c-.42.234-.828.403-1.223.507a8.9 8.9.0 01-1.333.235c.45.39.676 1.005.676 1.846v3.11c0 .147.021.266.065.357a.36.36.0 00.208.189c.096.034.18.056.254.064.074.01.18.013.318.013h2.914c1.032.0 1.914-.366 2.647-1.099.732-.732 1.099-1.615 1.099-2.647V3.746c0-1.032-.367-1.914-1.1-2.647z"/></svg></a><a target=_blank class=social rel=me title=Mastodon href=https://mwtaylor.social/@Michael><svg xmlns="http://www.w3.org/2000/svg" width="1.2em" height="1.2em" viewBox="0 0 24 24"><path fill="currentcolor" d="M20.94 14c-.28 1.41-2.44 2.96-4.97 3.26-1.31.15-2.6.3-3.97.24-2.25-.11-4-.54-4-.54v.62c.32 2.22 2.22 2.35 4.03 2.42 1.82.05 3.44-.46 3.44-.46l.08 1.65s-1.28.68-3.55.81c-1.25.07-2.81-.03-4.62-.5-3.92-1.05-4.6-5.24-4.7-9.5l-.01-3.43c0-4.34 2.83-5.61 2.83-5.61C6.95 2.3 9.41 2 11.97 2h.06c2.56.0 5.02.3 6.47.96.0.0 2.83 1.27 2.83 5.61.0.0.04 3.21-.39 5.43M18 8.91c0-1.08-.3-1.91-.85-2.56-.56-.63-1.3-.96-2.23-.96-1.06.0-1.87.41-2.42 1.23l-.5.88-.5-.88c-.56-.82-1.36-1.23-2.43-1.23-.92.0-1.66.33-2.23.96C6.29 7 6 7.83 6 8.91v5.26h2.1V9.06c0-1.06.45-1.62 1.36-1.62 1 0 1.5.65 1.5 1.93v2.79h2.07V9.37c0-1.28.5-1.93 1.51-1.93.9.0 1.35.56 1.35 1.62v5.11H18V8.91z"/></svg></a><p class=footnote>powered by <a target=_blank href=https://gohugo.io>Hugo</a> | themed with <a target=_blank href=https://github.com/lukeorth/poison>poison</a><br><br><a rel=license href=http://creativecommons.org/licenses/by/4.0/><img alt="Creative Commons License" style=border-width:0 src=https://i.creativecommons.org/l/by/4.0/88x31.png></a>
This work is licensed under a <a rel=license href=http://creativecommons.org/licenses/by/4.0/>Creative Commons Attribution 4.0 International License</a>.</p></div></aside><main class="content container"><div class=post><div class=info><h1 class=post-title><a href=https://elephantintheroom.dev/posts/mastodon-federation/>Federating Your New Server</a></h1><time datetime=2023-09-12T21:57:21-0700 class=post-date>September 12, 2023</time><p class=seriesname>Series: <a href=https://elephantintheroom.dev/series/personal-mastodon-server>Personal Mastodon Server</a></p></div><p>At this point in the series on setting up a personal Mastodon server you should have your server setup and running.</p><p>You are excited to get started reading posts from other users and sharing your thoughts with the world. But you open
the home page of your server and it&rsquo;s empty. You were promised that Mastodon servers all federate with each other.
What&rsquo;s going on? It&rsquo;s a bit complicated and takes a bit of work to get federation going.</p><h1 id=how-does-federation-work>How Does Federation Work?</h1><p>There is not one central authority of all Mastodon servers in existence. The point of Mastodon is to be decentralized
without a single entity controlling information. This means you can&rsquo;t just &ldquo;turn on&rdquo; federation and get going.</p><p>So how do Mastodon servers learn about each other? The simple answer is by users following users on other servers. When
you follow a user your server sends a request to the other server to establish a link. Now the other server knows about
your server and will send all new posts from the user you followed over for you to read.</p><p>It&rsquo;s not actually that simple, but is enough to know to move forward with the rest of this post to get started. At the
end will be a deeper dive into federation and some gotchas to keep in mind.</p><h1 id=getting-started-on-your-new-server>Getting Started On Your New Server</h1><p>My recommendation to get federated is actually to just start posting. You aren&rsquo;t federated with any other servers yet
and your posts won&rsquo;t be sent anywhere, but it establishes a bit about who you are so other users can decide to follow
you later. Just keep in mind that you should not post more than 5 posts at this point, more on that later.</p><h2 id=what-should-you-post>What should you post?</h2><p>A common way among Mastodon users to get started is to post an introduction about yourself. For your first post write a
short bit about yourself and your interests. Potentially include some hashtags related to content you intend to post
about or want to read. Include the hashtag #introduction in your post. This helps everyone discover new interesting
people to follow by following the #introduction hashtag.</p><p>You can write a few other posts that give other users a feeling for what you will continue to post about moving forward.
Pet pictures are always popular on Mastodon, just be sure to include the relevant hashtag #DogsOfMastodon or
#CatsOfMastodon.</p><p>Each post you write at this point should be pinned on your profile. This is why to not post more than 5 posts because
that is the limit of pinned posts you can have. This is important because only pinned posts are sent to other servers
to start. Once one user on a server follows you then all subsequent users following you from the same server will see
all your posts that were posted after the time of the first follow.</p><p><img src=MyPinnedPosts.png alt="A screenshot from my Mastodon feed showing my two first pinned posts." title="Example of my pinned posts on Mastodon"></p><p>Learn more about <a href=https://docs.joinmastodon.org/user/discoverability/ target=_blank>discoverability</a> in the Mastodon documentation.</p><h2 id=fill-out-your-profile>Fill Out Your Profile</h2><p>Also be sure to fill out all the other details on your profile. See the <a href=https://docs.joinmastodon.org/user/profile/ target=_blank>Mastodon documentation</a> for all
you can set up. The bio may be similar to the content of your #introduction post but go ahead and write both.</p><p>A good profile picture and header banner are important to really make your profile stand out.</p><p><img src=MyProfile.png alt="A screenshot showing what I have in my Mastodon profile." title="Example of my profile"></p><h1 id=find-other-users-to-follow>Find Other Users To Follow</h1><p>Finding other users to follow can be a challenge because their posts are not being sent to your server. Here&rsquo;s a few
ways to start following users.</p><h2 id=users-you-know-from-other-services>Users You Know From Other Services</h2><p>If there are blogs or other sources of content you read and the author has linked a Mastodon profile then you can follow
them. Take note of both their username, and the server they are on. For example take a look at my Mastodon link on the
left that links to <a href=https://mwtaylor.social/@Michael target=_blank>https://mwtaylor.social/@Michael</a>. My username is <em>@Michael</em> and
the server I am on is <em>mwtaylor.social</em>. Go to your server and use the search. Either copy in the link to their user
or search for @username@server (example <em>@Michael@mwtaylor.social</em>).</p><p>Now you can view their profile and follow them. Remember that you will only see their pinned posts and posts they made
after you start following them.</p><h2 id=finding-other-users>Finding Other Users</h2><p>A good way to start finding other interesting users to follow is to browse on <a href=https://mastodon.social/explore target=_blank>mastodon.social Explore</a>. This shows
posts from all the users that are known to the largest Mastodon server that have been getting a lot of favorites or
boosts.</p><p>When you find a user you want to follow copy the link for the user and search for it on your server.</p><h2 id=getting-follows-back>Getting Follows Back</h2><p>Hopefully some of the users you follow will see your profile and pinned posts and decide to follow you back. This will
start sending your posts to that users server which will further increase the chances of someone else discovering you
and following you.</p><h1 id=revisiting-how-federation-works>Revisiting How Federation Works</h1><p>Now that you have a little experience with getting federation going let&rsquo;s dive deeper into what&rsquo;s actually going on.
This should help you better understand some of the behaviors you experienced in the previous sections.</p><h2 id=how-are-posts-stored-across-servers>How Are Posts Stored Across Servers?</h2><p>It&rsquo;s important to understand how posts are stored. This will serve as a base for everything else federation related.</p><p>Each Mastodon server stores a copy of all posts it knows about. Posting on your server will store the original copy in
your server&rsquo;s database. Then your server will send a copy of your post to each Mastodon server that has at least one
user following you. When you view someone else&rsquo;s post from another server you are actually viewing the local copy your
server has stored. To see the original copy you will need to view it directly on that user&rsquo;s server.</p><p>Some things to note from how this storage works. Your posts will not be copied to all Mastodon servers, and not even
necessarily all the Mastodon servers federated with your server. This is why a user on a server with no other users
following you will not see your older posts. Pinned posts are handled specially which is why they are important. When
someone is looking at your profile on another server then that server will request and store your pinned posts.</p><h3 id=what-about-images>What About Images?</h3><p>Images are basically the same as posts but with one important distinction. They are copied on to all servers that know
about the related post. This can make your storage very expensive. So Mastodon has a server administration tool to
remove images after a certain amount of time. It will only remove images from other servers, so your original images
will be safe. Don&rsquo;t worry though, you can still go back and view these old posts with their images. Mastodon will fetch
the image again if it is needed.</p><p><a href=https://docs.joinmastodon.org/admin/tootctl/#media-remove target=_blank>Check the tootctl documentation for details</a>.</p><h2 id=favorites-boosts-and-replies>Favorites, Boosts, and Replies</h2><p>A post you see on your server probably won&rsquo;t have accurate counts for favorites, boosts, and replies. Servers don&rsquo;t
broadcast all of these events to all other servers so your server won&rsquo;t know about most of these events. To see the most
accurate count view the post on the original server or a large server like mastodon.social.</p><p>You should be able to see most of the replies, especially after you have been using your server for a while and have a
large federation network. Unfortunately though the only way to be sure you see all the replies is go to the original
server.</p><p>It is possible to favorite, boost, bookmark, or reply to a post that your server doesn&rsquo;t know about. Go to the post on
the original server. Copy the link and paste it into the search box on your server. This will force your server to
retrieve the post and store it in your database, then you can interact with it.</p><h2 id=following-hashtags>Following Hashtags</h2><p>Mastodon has a feature to follow hashtags you are interested in. But it doesn&rsquo;t work the same as following users and
this makes it not as useful of a feature on a single user Mastodon server.</p><p>When your server generates your feed using a followed hashtag it only filters the posts known to your server with that
hashtag. It does not search on any other servers for the hashtag. Also, other servers do not federate posts based on
hashtag following like they do for user following.</p><p>The result of this is following a hashtag will only show you posts you would have seen anyway.</p><h1 id=mastodon-relays>Mastodon Relays</h1><p>Mastodon supports using relays as a way to get more content to your server that it otherwise wouldn&rsquo;t have. They are
configured in the administration section of your server. I haven&rsquo;t used one but if you choose to you will have to
research the pros and cons of it. Relays can send a lot of information to your server and overwhelm cheap hardware. It
may also increase the amount of moderation work you have to do.</p><p><img src=RelaySetup.png alt="Screenshot of the Mastodon admin page to setup a relay" title="Setting up a Mastodon relay"></p><hr><div class=footer><p>This is a post in the <b><a href=https://elephantintheroom.dev/series/personal-mastodon-server>Personal Mastodon Server</a></b> series.<br>Other posts in this series:<ul class=series><li>September 15, 2023 -
<a href=/posts/mastodon-storage-management/>Mastodon Storage Management</a></li><li>September 15, 2023 -
<a href=/posts/mastodon-basic-monitoring/>Mastodon Basic Monitoring</a></li><li>September 12, 2023 -
Federating Your New Server</li><li>September 10, 2023 -
<a href=/posts/mastodon-setup/>Starting a Personal Mastodon Server</a></li></ul></p></div></div></main><div class=article-toc><div class=toc-wrapper><h4 id=contents></h4><nav id=TableOfContents><ul><li><a href=#how-does-federation-work>How Does Federation Work?</a></li><li><a href=#getting-started-on-your-new-server>Getting Started On Your New Server</a><ul><li><a href=#what-should-you-post>What should you post?</a></li><li><a href=#fill-out-your-profile>Fill Out Your Profile</a></li></ul></li><li><a href=#find-other-users-to-follow>Find Other Users To Follow</a><ul><li><a href=#users-you-know-from-other-services>Users You Know From Other Services</a></li><li><a href=#finding-other-users>Finding Other Users</a></li><li><a href=#getting-follows-back>Getting Follows Back</a></li></ul></li><li><a href=#revisiting-how-federation-works>Revisiting How Federation Works</a><ul><li><a href=#how-are-posts-stored-across-servers>How Are Posts Stored Across Servers?</a><ul><li><a href=#what-about-images>What About Images?</a></li></ul></li><li><a href=#favorites-boosts-and-replies>Favorites, Boosts, and Replies</a></li><li><a href=#following-hashtags>Following Hashtags</a></li></ul></li><li><a href=#mastodon-relays>Mastodon Relays</a></li></ul></nav></div></div></div></body></html>